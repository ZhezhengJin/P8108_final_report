---
title: "mc5296"
output: html_document
date: "2023-11-28"
---

```{r}
library(survival)
rotterdam
```
```{r}
rfs  <- pmax(rotterdam$recur, rotterdam$death)
rfstime <- with(rotterdam, ifelse(recur==1, rtime, dtime))
fit1 <- coxph(Surv(rfstime, rfs) ~ pspline(age) + size + grade + nodes + pgr + er + hormon + chemo, data = rotterdam)
summary(fit1)

```

```{r}
# Fit a basic Cox proportional hazards model
cox_model <- coxph(Surv(rtime, recur) ~ age + size + grade + nodes + pgr + er + hormon + chemo, data = rotterdam)
summary(cox_model)
```

```{r}
# Checking the Proportional Hazards assumption
cox.zph_model <- cox.zph(fit1)
plot(cox.zph_model)

```
Age: The residuals for age do not show a clear trend over time, suggesting that age satisfies the proportional hazards assumption.

Size: Similar to age, the plot for size does not indicate any systematic trend, indicating no violation of the proportional hazards assumption.

Grade: The plot for grade shows residuals scattered around the zero line without a distinct pattern, which suggests that the assumption holds.

Nodes: The residuals for nodes are also randomly distributed, which indicates no obvious violation of the assumption.

PGR: The plot for pgr again shows a random scatter, suggesting that the proportional hazards assumption may not be violated.

ER: As with pgr, the plot for er shows a random scatter of residuals, indicating that the assumption is likely met.

Hormon: The residuals for hormon do not display a distinct trend, suggesting the assumption is reasonable.

Chemo: The plot for chemo also shows residuals that are randomly distributed around the zero line, suggesting no violation of the proportional hazards assumption.
```{r}




```
