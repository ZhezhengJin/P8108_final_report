---
title: "Log-rank Test"
author: "Zhezheng Jin"
date: "2023-11-30"
output: github_document
---

```{r setup}
library(survival)
head(rotterdam, 30)
```

## Log-rank test (death as event) comparing hormonal treatment
```{r}
surv_obj1 <- Surv(time = rotterdam$dtime, event = rotterdam$death)

log_rank_test_hormon1 <- survdiff(surv_obj1 ~ hormon, data = rotterdam)

print(log_rank_test_hormon1)
```

Groups Compared: The test compared survival times between two groups: hormon=0 and hormon=1.

Number of Subjects (N): There were 2,643 subjects in the hormon=0 group and 339 subjects in the hormon=1 group.

The p-value of 1e-06 suggests that there is a statistically significant difference in survival between the two hormone treatment groups.
The very low p-value (much less than 0.05) leads us to reject the null hypothesis of no difference in survival between the two groups.
The result indicates that hormone treatment status (hormon) is strongly associated with differences in survival outcomes in the dataset. Specifically, the observed number of events in each group significantly deviates from what would be expected if there were no difference in survival between the groups.

## Log-rank test (recurrence as event) comparing hormonal treatment
```{r}
surv_obj2 <- Surv(time = rotterdam$rtime, event = rotterdam$recur)

log_rank_test_hormon2 <- survdiff(surv_obj2 ~ hormon, data = rotterdam)

print(log_rank_test_hormon2)
```

The p-value of 0.002 suggests that there is a statistically significant difference in the recurrence rate between the two hormone treatment groups.
Given that the p-value is less than 0.05, we reject the null hypothesis of no difference in recurrence rates between the two groups.
The result indicates that hormone treatment status (hormon) is associated with a difference in recurrence rates in the dataset. Specifically, the observed number of recurrences in each group deviates from what would be expected if there were no difference in recurrence rates between the groups.

## Log-rank test (combine both as event) comparing hormonal treatment
```{r}
rfs  <- pmax(rotterdam$recur, rotterdam$death)
rfstime <- with(rotterdam, ifelse(recur==1, rtime, dtime))
surv_obj3 <- Surv(time = rfstime, event = rfs)
log_rank_test_hormon3 <- survdiff(surv_obj3 ~ hormon, data = rotterdam)

print(log_rank_test_hormon3)
```

The p-value of 0.0003 suggests that there is a statistically significant difference in survival between the two hormone treatment groups.
The very low p-value (much less than 0.05) leads us to reject the null hypothesis of no difference in survival between the two groups.
The result indicates that hormone treatment status (hormon) is strongly associated with differences in survival outcomes in the dataset, when considering both recurrence and death as the events of interest. Specifically, the observed number of events in each group significantly deviates from what would be expected if there were no difference in survival between the groups.

## Stratified log-rank test (combine both as event) comparing hormonal treatment stratified by chemotherapy
```{r}
stratified_log_rank_test <- survdiff(surv_obj3 ~ hormon + strata(chemo), data = rotterdam)

print(stratified_log_rank_test)
```

Stratification: The test was stratified by the chemotherapy, meaning the analysis was conducted separately within each chemotherapy status group, but the overall test combines these analyses.

The p-value of 0.0001 suggests that there is a statistically significant difference in survival between the two hormone treatment groups when stratified by chemotherapy status.
The very low p-value (much less than 0.05) leads us to reject the null hypothesis of no difference in survival between the two groups within each stratum of chemotherapy status.
This result indicates that hormone treatment status (hormon) is strongly associated with differences in the combined outcomes of recurrence and death, and this association holds true even when accounting for whether patients received chemotherapy or not.

