---
title: "mc5296"
output: pdf_document
date: "2023-11-28"
---

```{r}
library(survival)
library(MASS)
head(rotterdam)
```


```{r}
rfs  <- pmax(rotterdam$recur, rotterdam$death)
rfstime <- with(rotterdam, ifelse(recur==1, rtime, dtime))
rotterdam$tstart = c(rep(0,2982))
surv_object <- with(rotterdam, Surv(tstart, rfstime, rfs)) #with consideration of time-varying covariates
```

```{r}
# Fit a basic Cox proportional hazards model
cox_model <- coxph(Surv(rfstime, rfs) ~ age + size + grade + nodes + pgr + er + hormon + chemo, data = rotterdam)
# Checking the Proportional Hazards assumption
cox.zph_model <- cox.zph(cox_model)
plot(cox.zph_model)

```

```{r}

```

```{r}
fit1 <- coxph(surv_object ~ pspline(age) + size + grade + nodes + pgr + er + hormon + chemo, data = rotterdam)
summary(fit1)
stepwise_model <- stepAIC(fit1, direction = "both", trace = FALSE)
summary(stepwise_model)
```

