---
title: "mc5296"
output: html_document
date: "2023-11-28"
---

```{r}
library(survival)
rotterdam
```
```{r}
rfs  <- pmax(rotterdam$recur, rotterdam$death)
rfstime <- with(rotterdam, ifelse(recur==1, rtime, dtime))
fit1 <- coxph(Surv(rfstime, rfs) ~ pspline(age) + size + grade + nodes + pgr + er + hormon + chemo, data = rotterdam)
summary(fit1)

```

```{r}
# Fit a basic Cox proportional hazards model
cox_model <- coxph(Surv(rfstime, rfs) ~ age + size + grade + nodes + pgr + er + hormon + chemo, data = rotterdam)
summary(cox_model)
```

```{r}
# Checking the Proportional Hazards assumption
cox.zph_model <- cox.zph(fit1)
plot(cox.zph_model)

```
Age: The residuals for age do not show a clear trend over time, suggesting that age satisfies the proportional hazards assumption.

Size: Similar to age, the plot for size does not indicate any systematic trend, indicating no violation of the proportional hazards assumption.

Grade: The plot for grade shows residuals scattered around the zero line without a distinct pattern, which suggests that the assumption holds.

Nodes: The residuals for nodes are also randomly distributed, which indicates no obvious violation of the assumption.

PGR: The plot for pgr again shows a random scatter, suggesting that the proportional hazards assumption may not be violated.

ER: As with pgr, the plot for er shows a random scatter of residuals, indicating that the assumption is likely met.

Hormon: The residuals for hormon do not display a distinct trend, suggesting the assumption is reasonable.

Chemo: The plot for chemo also shows residuals that are randomly distributed around the zero line, suggesting no violation of the proportional hazards assumption.



Coefficients and Hazard Ratios
Age: For each year increase in age, the hazard increases by a factor of 1.0045 (p = 0.0447). This is statistically significant at the 5% level.
Size (20-50 vs <=20): The hazard is 1.4287 times higher for size 20-50 compared to <=20 (p < 2e-16), which is statistically significant.
Size (>50 vs <=20): The hazard is 1.9040 times higher for size >50 compared to <=20 (p < 2e-16), also statistically significant.
Grade: Each unit increase in grade is associated with a 1.3845 times increase in the hazard (p < 2e-16), which is statistically significant.
Nodes: Each additional node is associated with a 1.0773 times increase in the hazard (p < 2e-16), which is statistically significant.
Pgr and ER: The hazard ratios are very close to 1, and the p-values indicate that these are not statistically significant predictors in the model.
Hormon: Being on hormone treatment is associated with a hazard ratio of 0.8798 compared to not being on hormone treatment, but this is not statistically significant at the 5% level (p = 0.0978).
Chemo: Being on chemotherapy is associated with a hazard ratio of 0.9109 compared to not being on chemotherapy, but this is not statistically significant at the 5% level (p = 0.1746).
Model Fit
Concordance: 0.668. This statistic is a measure of the model's predictive ability (1 is perfect, 0.5 is no better than chance).
Likelihood Ratio Test: 490.1 on 9 degrees of freedom with p < 2e-16, indicating that the model as a whole is statistically significant.
Wald Test: 614.3 on 9 degrees of freedom with p < 2e-16, also indicating the overall significance of the model.
Score (Logrank) Test: 678.1 on 9 degrees of freedom with p < 2e-16, further confirming the model's significance.
